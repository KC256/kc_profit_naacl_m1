nohup: 入力を無視します
/home/fukuda/miniconda3/envs/Profit-naacl/lib/python3.9/site-packages/pyfolio/pos.py:26: UserWarning: Module "zipline.assets" not found; mutltipliers will not be applied to position notionals.
  warnings.warn(
start time: 2024-11-06 19:31:12.900588
INPUT_TEXT: tweetonly
USING_MODEL: model_2
output is not made
train_pickle:  ../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl
test_pickle:  ../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl
args.validate_steps: 25
args.epsilon: 50000
HMAX_NORMALIZE: 10
SELECT_ACTION: default
TRANSACTION_FEE_PERCENT 0.000495
args.train_iter: 200000
args.seed: -1
args.bsize: 1
{'mode': 'test', 'env': 'Humanoid-v2', 'hidden1': 400, 'hidden2': 300, 'rate': 0.001, 'prate': 0.0001, 'warmup': 25, 'discount': 0.99, 'bsize': 1, 'rmsize': 25, 'window_length': 1, 'tau': 0.001, 'ou_theta': 0.15, 'ou_sigma': 0.2, 'ou_mu': 0.0, 'validate_episodes': 1, 'max_episode_length': 500, 'validate_steps': 25, 'output': 'output', 'debug': False, 'init_w': 0.003, 'train_iter': 200000, 'epsilon': 50000, 'seed': -1, 'resume': 'default', 'model': 'time', 'diff': None, 'test_pickle': '../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl', 'train_pickle': '../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl', 'initial_account_balance': '100000', 'resumes_folder_path': '../../output_2/Humanoid-v2-run8/step_27200'}
MEMO:
          
this is test mode
['actor.pkl', 'actor_target.pkl', 'critic_target.pkl', 'critic.pkl']
stepは１種類のみ
step 27200
test model: ../../output_2/Humanoid-v2-run8/step_27200
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[-0.5040, -0.4816, -0.9418, -0.8240,  1.6022,  0.5891, -1.5022,  1.1637,
         -1.0351, -0.2681, -0.1465,  1.5852, -0.3546, -0.7393,  0.9136, -0.4229,
          0.5932, -0.2943,  1.9570, -0.8895]], device='cuda:0',
       grad_fn=<DivBackward0>)
action1: [-0.50396174 -0.4815859  -0.941849   -0.82399184  1.6022025   0.5890587
 -1.5022435   1.1636987  -1.0351102  -0.2681232  -0.14647903  1.5851907
 -0.35460982 -0.73932666  0.91364074 -0.42290866  0.59323573 -0.29433763
  1.9569805  -0.88947994] <class 'numpy.ndarray'>
day: 0 eval
actions: [ -5.0396175  -4.815859   -9.418489   -8.239919   16.022026    5.890587
 -15.022435   11.636987  -10.351103   -2.681232   -1.4647902  15.851907
  -3.5460982  -7.3932667   9.136408   -4.229087    5.9323573  -2.9433763
  19.569805   -8.894799 ]
argsort_actions: [ 6  8  2 19  3 13  0  1 15 12 17  9 10  5 16 14  7 11  4 18]
sell index:[ 6  8  2 19  3 13  0  1 15 12 17  9 10]  buy index:[18  4 11  7 14 16  5] 
self.sell_num, self.buy_num, self.hold_num: 0 7 13
self.state[HOLDING_IDX~EMB_IDX]: [0, 0, 0, 0, 16.02202606201172, 5.890586853027344, 0, 11.63698673248291, 0, 0, 0, 15.851906776428223, 0, 0, 9.136407852172852, 0, 5.932357311248779, 0, 19.569805145263672, 0]
diff_previousday_state[HOLDING_IDX~EMB_IDX]: [ 0.          0.          0.          0.         16.02202606  5.89058685
  0.         11.63698673  0.          0.          0.         15.85190678
  0.          0.          9.13640785  0.          5.93235731  0.
 19.56980515  0.        ]
self.state[TARGET_IDX:PRICEDIFF~IDX]: [52.269245, 133.142044, 520.719971, 122.81459, 181.770004, 24.214939, 63.970062, 132.808884, 23.851751, 28.211098, 37.610397, 89.324226, 93.24482, 88.680862, 29.549698, 30.251495, 113.232193, 92.87384, 68.830414, 68.946892]
daybefore_stockprices: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
stockprices_raio: [1, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
hold_price_ratio [0.916945303808613, 0.0, 0.0, 0.0, 0.0, 0.029124434730509324, 0.0014264606555485886, 0.0, 0.01545558759578707, 0.0, 0.0, 0.0, 0.014160175164531401, 0.0, 0.0, 0.0026998919219603347, 0.0, 0.006717614443835414, 0.0, 0.013470531679214793, 0.0]
y_w: [0.916945303808613, 0.0, 0.0, 0.0, 0.0, 0.029124434730509324, 0.0014264606555485886, 0.0, 0.01545558759578707, 0.0, 0.0, 0.0, 0.014160175164531401, 0.0, 0.0, 0.0026998919219603347, 0.0, 0.006717614443835414, 0.0, 0.013470531679214793, 0.0]
sum(y_w): 0.9999999999999999
end_total_asset [   0.            0.            0.            0.         2912.32374138
  142.64020132    0.         1545.49522106    0.            0.
    0.         1415.95930343    0.            0.          269.97809284
    0.          671.73382801    0.         1346.99779005    0.        ]
begin_total_asset [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
self.daybefore_end_total_asset [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
self.args.diff: None
self.reward: -0.00041110384481580695
sum end_total_asset(stocks): 8305.12817808935
self.state[0](cash): 91690.7607834625
today cost: 4.111038448154228
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[-0.5038, -0.4835, -0.9414, -0.8269,  1.6038,  0.5906, -1.4979,  1.1629,
         -1.0337, -0.2718, -0.1506,  1.5828, -0.3554, -0.7384,  0.9133, -0.4250,
          0.5989, -0.2951,  1.9584, -0.8874]], device='cuda:0',
       grad_fn=<DivBackward0>)
action1: [-0.5038382  -0.48346138 -0.9414043  -0.8268783   1.6038445   0.590639
 -1.497918    1.1629268  -1.0336907  -0.27176285 -0.15056574  1.5827804
 -0.35544556 -0.7383887   0.9133008  -0.4249722   0.5989244  -0.2950573
  1.9583931  -0.88742554] <class 'numpy.ndarray'>
day: 1 eval
actions: [ -5.0383816  -4.834614   -9.414042   -8.268784   16.038445    5.90639
 -14.97918    11.629268  -10.336906   -2.7176285  -1.5056574  15.827804
  -3.5544558  -7.3838873   9.133008   -4.249722    5.989244   -2.950573
  19.583931   -8.874255 ]
argsort_actions: [ 6  8  2 19  3 13  0  1 15 12 17  9 10  5 16 14  7 11  4 18]
sell index:[ 6  8  2 19  3 13  0  1 15 12 17  9 10]  buy index:[18  4 11  7 14 16  5] 
self.sell_num, self.buy_num, self.hold_num: 0 7 13
self.state[HOLDING_IDX~EMB_IDX]: [0, 0, 0, 0, 32.06047058105469, 11.796977043151855, 0, 23.266254425048828, 0, 0, 0, 31.679710388183594, 0, 0, 18.269415855407715, 0, 11.921601295471191, 0, 39.15373611450195, 0]
diff_previousday_state[HOLDING_IDX~EMB_IDX]: [ 0.          0.          0.          0.         16.03844452  5.90639019
  0.         11.62926769  0.          0.          0.         15.82780361
  0.          0.          9.133008    0.          5.98924398  0.
 19.58393097  0.        ]
self.state[TARGET_IDX:PRICEDIFF~IDX]: [52.436836, 135.268829, 532.539978, 124.648239, 183.139999, 24.243172, 64.967117, 133.722, 24.116873, 28.690685, 38.167938, 90.643471, 94.198227, 88.973793, 30.700506, 30.659801, 115.387878, 93.627548, 69.499153, 70.641235]
daybefore_stockprices: [52.269245, 133.142044, 520.719971, 122.81459, 181.770004, 24.214939, 63.970062, 132.808884, 23.851751, 28.211098, 37.610397, 89.324226, 93.24482, 88.680862, 29.549698, 30.251495, 113.232193, 92.87384, 68.830414, 68.946892]
stockprices_raio: [1, 1.0032063022911466, 1.0159738046383004, 1.0226993540833487, 1.0149302212383724, 1.007536969631139, 1.0011659331456504, 1.0155862753423626, 1.006875413545377, 1.0111154103528919, 1.0169999409452266, 1.0148241189796534, 1.0147691735946305, 1.0102247717353092, 1.0033032042471577, 1.0389448311789853, 1.0134970519638782, 1.019037739558749, 1.0081153961115423, 1.009715748622404, 1.0245746102666962]
hold_price_ratio [0.8321576539380405, 0.0, 0.0, 0.0, 0.0, 0.05866757062902908, 0.0028576246388033323, 0.0, 0.031086679892404163, 0.0, 0.0, 0.0, 0.02869212637310804, 0.0, 0.0, 0.0056042203106457435, 0.0, 0.01374484303803065, 0.0, 0.027189281179938525, 0.0]
y_w: [0.8321576539380405, 0.0, 0.0, 0.0, 0.0, 0.05910974632719277, 0.00286095643808754, 0.0, 0.0313004136724172, 0.0, 0.0, 0.0, 0.02911588536831155, 0.0, 0.0, 0.005822475724533683, 0.0, 0.014006513780064563, 0.0, 0.02745344540110667, 0.0]
sum(y_w): 1.0018270906497546
end_total_asset [   0.            0.            0.            0.         5871.55455015
  285.99614354    0.         3111.21007423    0.            0.
    0.         2871.55890986    0.            0.          560.88031109
    0.         1375.60827585    0.         2721.15149674    0.        ]
begin_total_asset [   0.            0.            0.            0.         2934.27383697
  142.80651026    0.         1556.12113984    0.            0.
    0.         1436.87185218    0.            0.          280.49234408
    0.          684.52212168    0.         1360.08488197    0.        ]
self.daybefore_end_total_asset [   0.            0.            0.            0.         2912.32374138
  142.64020132    0.         1545.49522106    0.            0.
    0.         1415.95930343    0.            0.          269.97809284
    0.          671.73382801    0.         1346.99779005    0.        ]
self.args.diff: None
self.reward: 0.008588512930514117
sum end_total_asset(stocks): 16797.959761452472
self.state[0](cash): 83283.81432940451
today cost: 4.159379601855773
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[-0.5037, -0.4857, -0.9409, -0.8303,  1.6059,  0.5924, -1.4928,  1.1620,
         -1.0319, -0.2761, -0.1555,  1.5799, -0.3564, -0.7373,  0.9129, -0.4274,
          0.6056, -0.2959,  1.9601, -0.8850]], device='cuda:0',
       grad_fn=<DivBackward0>)
action1: [-0.5037314  -0.48567137 -0.94085073 -0.8302905   1.6058643   0.5924378
 -1.4927815   1.161967   -1.0318898  -0.27608147 -0.15546706  1.5799286
 -0.35641128 -0.7372972   0.912924   -0.42737165  0.6055786  -0.29593113
  1.9600674  -0.8849923 ] <class 'numpy.ndarray'>
day: 2 eval
Reached the end.
self.asset_memory: [100000, 99995.88896155184, 100081.77409085698]
previous_total_asset:100000
end_total_asset:100081.77409085698
total_reward:81.7740908569831
total_cost:  8.27041805001
total trades:  14
[Evaluate] Step_27200: mean_reward:0.016765922016212426 mean_sharpe:10.19949556844402 mean_sortino:223.2894533369369 mean_calmar:1728.864952943485 mean_mdd:-0.004111038448158411 mean_cum_returns:0.0817740908569831
all finish
