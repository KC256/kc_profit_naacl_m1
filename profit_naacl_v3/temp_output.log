nohup: 入力を無視します
/home/fukuda/miniconda3/envs/Profit-naacl/lib/python3.9/site-packages/pyfolio/pos.py:26: UserWarning: Module "zipline.assets" not found; mutltipliers will not be applied to position notionals.
  warnings.warn(
start time: 2025-01-14 00:45:14.090059
INPUT_TEXT: tweetonly
USING_MODEL: model_2
output is not made
train_pickle:  ../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl
test_pickle:  ../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl
args.validate_steps: 25
args.epsilon: 50000
HMAX_NORMALIZE: 10
SELECT_ACTION: default
TRANSACTION_FEE_PERCENT 0.000495
args.train_iter: 3
args.seed: 1
args.bsize: 1
{'mode': 'train', 'env': 'Humanoid-v2', 'hidden1': 400, 'hidden2': 300, 'rate': 0.001, 'prate': 0.0001, 'warmup': 1, 'discount': 0.99, 'bsize': 1, 'rmsize': 25, 'window_length': 1, 'tau': 0.001, 'ou_theta': 0.15, 'ou_sigma': 0.2, 'ou_mu': 0.0, 'validate_episodes': 1, 'max_episode_length': 500, 'validate_steps': 25, 'output': 'output_m1', 'debug': False, 'init_w': 0.003, 'train_iter': 3, 'epsilon': 50000, 'seed': 1, 'resume': 'default', 'model': 'time', 'diff': 'portfolio_var', 'test_pickle': '../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl', 'train_pickle': '../../datasets/pickles_0tumeru/S_test_data_sorted_in_jsons_6_2015-10-01~2015-10-03_20_7_5_384.pkl', 'initial_account_balance': '100000', 'resumes_folder_path': None, 'wantoutput': 'no'}
MEMO:
          
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  3.56it/s] 67%|██████▋   | 2/3 [00:00<00:00,  4.44it/s]args.warmup  1

step: 0
day: 0 train
actions: [ 6.59325843 -2.25208293 -0.54903345  1.50666188  3.66502888  7.28033054
 -6.92732355  4.15186702 -0.31762373  1.46469228 -0.64424463 -5.1691582
  7.8575984  -6.16543592 -6.17582704 -4.97517194  4.14713845  2.51350195
  9.00688045  2.24823675]
argsort_actions: [ 6 14 13 11 15  1 10  2  8  9  3 19 17  4 16  7  0  5 12 18]
sell index:[ 6 14 13 11 15  1 10  2  8]  buy index:[18 12  5  0  7 16  4 17 19  3  9] 
self.sell_num, self.buy_num, self.hold_num: 0 11 9
self.state[HOLDING_IDX~EMB_IDX]: [6.593258431246769, 0, 0, 1.5066618800094411, 3.665028881169541, 7.280330537388869, 0, 4.151867017685094, 0, 1.4646922802117435, 0, 0, 7.857598397482654, 0, 0, 0, 4.147138450587153, 2.5135019519873447, 9.00688045387801, 2.2482367518476276]
diff_previousday_state[HOLDING_IDX~EMB_IDX]: [6.59325843 0.         0.         1.50666188 3.66502888 7.28033054
 0.         4.15186702 0.         1.46469228 0.         0.
 7.8575984  0.         0.         0.         4.14713845 2.51350195
 9.00688045 2.24823675]
self.state[TARGET_IDX:PRICEDIFF~IDX]: [52.269245, 133.142044, 520.719971, 122.81459, 181.770004, 24.214939, 63.970062, 132.808884, 23.851751, 28.211098, 37.610397, 89.324226, 93.24482, 88.680862, 29.549698, 30.251495, 113.232193, 92.87384, 68.830414, 68.946892]
daybefore_stockprices: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
stockprices_raio: [1, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
hold_price_ratio [0.9582437376132824, 0.0034463176345842085, 0.0, 0.0, 0.0018504388571975283, 0.006662060841523373, 0.0017629640371944382, 0.0, 0.005514162223144224, 0.0, 0.00041321431526369706, 0.0, 0.0, 0.007326954922320267, 0.0, 0.0, 0.0, 0.004695992875459647, 0.0023344340315220747, 0.006199601243967997, 0.0015501214045401284]
y_w: [0.9582437376132824, 0.0034463176345842085, 0.0, 0.0, 0.0018504388571975283, 0.006662060841523373, 0.0017629640371944382, 0.0, 0.005514162223144224, 0.0, 0.00041321431526369706, 0.0, 0.0, 0.007326954922320267, 0.0, 0.0, 0.0, 0.004695992875459647, 0.0023344340315220747, 0.006199601243967997, 0.0015501214045401284]
sum(y_w): 1.0
variance_hold_price_ratio: 0.04146797172594738
sum(y_w)/variance_hold_price_ratio: 24.114996668001467
end_total_asset [344.62464029   0.           0.         185.04006106 666.19231439
 176.29275986   0.         551.40482514   0.          41.32057746
   0.           0.         732.68034821   0.           0.
   0.         469.58958143 233.43857813 619.94731049 155.00893652]
begin_total_asset [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
self.daybefore_end_total_asset [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
self.args.diff: portfolio_var
self.reward: 0.002411499666800147
sum end_total_asset(stocks): 4175.53993297594
self.state[0](cash): 95822.39317475726
today cost: 2.066892266823091
step_end: 1

step: 1
day: 1 train
actions: [ 8.92202479 -3.81272539 -8.37853161  7.18961267  3.68380131 -5.15479482
  1.36062443 -3.916081    9.24431774 -9.96311219  4.12823801 -0.35179953
 -6.96763547  6.64687454  0.8388697  -3.55132208  8.07552432  1.94969104
  9.9622009   2.39422519]
argsort_actions: [ 9  2 12  5  7  1 15 11 14  6 17 19  4 10 13  3 16  0  8 18]
sell index:[ 9  2 12  5  7  1 15 11]  buy index:[18  8  0 16  3 13 10  4 19 17  6 14] 
self.sell_num, self.buy_num, self.hold_num: 4 12 4
self.state[HOLDING_IDX~EMB_IDX]: [15.515283224807016, 0, 0, 8.696274546491434, 7.3488301954379125, 2.1255357143843554, 1.3606244278773638, 0.23578601568856827, 9.244317741429612, 0.0, 4.128238007324301, 0, 0.8899629248727425, 6.6468745389548545, 0.8388697025814063, 0, 12.222662769383136, 4.463192991479124, 18.96908135853785, 4.642461936920979]
diff_previousday_state[HOLDING_IDX~EMB_IDX]: [ 8.92202479  0.          0.          7.18961267  3.68380131 -5.15479482
  1.36062443 -3.916081    9.24431774 -1.46469228  4.12823801  0.
 -6.96763547  6.64687454  0.8388697   0.          8.07552432  1.94969104
  9.9622009   2.39422519]
self.state[TARGET_IDX:PRICEDIFF~IDX]: [52.436836, 135.268829, 532.539978, 124.648239, 183.139999, 24.243172, 64.967117, 133.722, 24.116873, 28.690685, 38.167938, 90.643471, 94.198227, 88.973793, 30.700506, 30.659801, 115.387878, 93.627548, 69.499153, 70.641235]
daybefore_stockprices: [52.269245, 133.142044, 520.719971, 122.81459, 181.770004, 24.214939, 63.970062, 132.808884, 23.851751, 28.211098, 37.610397, 89.324226, 93.24482, 88.680862, 29.549698, 30.251495, 113.232193, 92.87384, 68.830414, 68.946892]
stockprices_raio: [1, 1.0032063022911466, 1.0159738046383004, 1.0226993540833487, 1.0149302212383724, 1.007536969631139, 1.0011659331456504, 1.0155862753423626, 1.006875413545377, 1.0111154103528919, 1.0169999409452266, 1.0148241189796534, 1.0147691735946305, 1.0102247717353092, 1.0033032042471577, 1.0389448311789853, 1.0134970519638782, 1.019037739558749, 1.0081153961115423, 1.009715748622404, 1.0245746102666962]
hold_price_ratio [0.9203203562802428, 0.00813275615468486, 0.0, 0.0, 0.010835799334628202, 0.013453738571489637, 0.0005151093270325698, 0.000883636044523745, 0.0003151827725989652, 0.0022286271920987726, 0.0, 0.0015750886077450553, 0.0, 0.0008380235197342099, 0.005911819299699155, 0.0002574433079408716, 0.0, 0.014098327033508709, 0.004177253971819562, 0.013178542314212883, 0.003278296268039982]
y_w: [0.9203203562802428, 0.008158832229376963, 0.0, 0.0, 0.01099758021598881, 0.013555138990528237, 0.0005157099100705908, 0.0008974086392161282, 0.00031734978450296164, 0.0022533992978625637, 0.0, 0.0015984379086697647, 0.0, 0.0008465921189323126, 0.00593134724631835, 0.0002674693941067883, 0.0, 0.014366727311786719, 0.004211154042459391, 0.013306581718547488, 0.003358859121165829]
sum(y_w): 1.0009029442097759
variance_hold_price_ratio: 0.03810381022560358
sum(y_w)/variance_hold_price_ratio: 26.26779154850048
end_total_asset [ 813.57236195    0.            0.         1083.97530808 1345.86475464
   51.52972792   88.3958464    31.52977759  222.94403694    0.
  157.56633231    0.           83.83292962  591.39763933   25.75372434
    0.         1410.34712047  417.87781604 1318.33508761  327.94924466]
begin_total_asset [345.72961106   0.           0.         187.80275011 671.21338563
 176.49830543   0.         555.19596134   0.          42.02302483
   0.           0.         740.17183752   0.           0.
   0.         478.52950559 235.33302466 625.97056272 158.81822072]
self.daybefore_end_total_asset [344.62464029   0.           0.         185.04006106 666.19231439
 176.29275986   0.         551.40482514   0.          41.32057746
   0.           0.         732.68034821   0.           0.
   0.         469.58958143 233.43857813 619.94731049 155.00893652]
self.args.diff: portfolio_var
self.reward: 0.0026267791548500482
sum end_total_asset(stocks): 7970.871707901209
self.state[0](cash): 92065.61610491728
today cost: 2.6073999504676566
step_end: 2

step: 2
step == args.warmup+1
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[ 0.8185,  0.1468,  0.1005, -0.3814, -1.2605, -0.3524, -0.3128,  0.5178,
         -0.3472,  2.0241,  1.2573,  0.4622, -0.0213,  0.3090,  0.8957,  0.5987,
         -2.7134, -0.6844, -0.0727, -0.9844]], device='cuda:0',
       grad_fn=<DivBackward0>)
action1: [ 0.8185124   0.1467856   0.10048825 -0.3813662  -1.2605311  -0.35242134
 -0.3128247   0.5178301  -0.34717512  2.024062    1.2573057   0.46224076
 -0.02134815  0.30896372  0.89567477  0.5987195  -2.7134209  -0.68443197
 -0.07270217 -0.98436123] <class 'numpy.ndarray'>
action2: [ 0.8109858   0.12236842  0.11664832 -0.38646916 -1.2915082  -0.3442908
 -0.33236656  0.5111075  -0.35073483  2.0213852   1.2802838   0.46975666
 -0.01539127  0.29964688  0.92248386  0.59777385 -2.7212815  -0.6652791
 -0.09360252 -0.99986243]
action3: [ 0.8109858   0.12236842  0.11664832 -0.38646916 -1.         -0.3442908
 -0.33236656  0.5111075  -0.35073483  1.          1.          0.46975666
 -0.01539127  0.29964688  0.92248386  0.59777385 -1.         -0.6652791
 -0.09360252 -0.99986243]
day: 2 train
Reached the end.
self.asset_memory: [100000, 99997.9331077332, 100036.4878128185]
previous_total_asset:100000
100%|██████████| 3/3 [00:03<00:00,  1.70s/it]100%|██████████| 3/3 [00:03<00:00,  1.31s/it]
end_total_asset:100036.4878128185
total_reward:36.487812818493694
total_cost:  4.6742922172907475
total trades:  27
size: 1
next_state_batch [[9.20656161e+04 5.24368360e+01 1.35268829e+02 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]]
to_tensor(next_state_batch, volatile=True) torch.Size([1, 269801])
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[ 0.8184,  0.1469,  0.1006, -0.3814, -1.2605, -0.3524, -0.3128,  0.5179,
         -0.3472,  2.0241,  1.2574,  0.4622, -0.0214,  0.3089,  0.8957,  0.5988,
         -2.7133, -0.6846, -0.0728, -0.9844]], device='cuda:0',
       grad_fn=<DivBackward0>)
target_q_batch: tensor([[40.9468]], device='cuda:0')
value_loss: tensor(4.9279, device='cuda:0', grad_fn=<MseLossBackward0>)
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[ 0.8183,  0.1467,  0.1005, -0.3814, -1.2603, -0.3526, -0.3131,  0.5177,
         -0.3465,  2.0241,  1.2567,  0.4628, -0.0211,  0.3086,  0.8956,  0.5992,
         -2.7138, -0.6843, -0.0726, -0.9844]], device='cuda:0',
       grad_fn=<DivBackward0>)
policy_loss: tensor([[10.8785]], device='cuda:0', grad_fn=<NegBackward0>)
policy_loss_mean: tensor(10.8785, device='cuda:0', grad_fn=<MeanBackward0>)
step_end: 3
state.shape torch.Size([1, 269801])
normalized_tensor tensor([[ 0.7742,  0.1721,  0.0430, -0.3475, -1.1910, -0.3047, -0.3676,  0.5633,
         -0.3894,  2.0405,  1.2815,  0.4980, -0.0513,  0.2655,  0.8518,  0.6369,
         -2.7267, -0.6383, -0.0991, -1.0111]], device='cuda:0',
       grad_fn=<DivBackward0>)
action1: [ 0.774171    0.17209889  0.0429775  -0.34753606 -1.1910374  -0.30470344
 -0.3676308   0.56332886 -0.38938165  2.0404916   1.2815293   0.49799782
 -0.05131447  0.26553994  0.85182947  0.636877   -2.7267277  -0.6382554
 -0.09914279 -1.0111119 ] <class 'numpy.ndarray'>
action2: [ 0.7608398   0.1622405   0.0333223  -0.38489273 -1.2356387  -0.3124629
 -0.4031734   0.54896516 -0.40851027  2.0555937   1.3167902   0.49950376
 -0.05555831  0.24666756  0.8899747   0.63955486 -2.701833   -0.5820037
 -0.09643647 -1.0414727 ]
action3: [ 0.7608398   0.1622405   0.0333223  -0.38489273 -1.         -0.3124629
 -0.4031734   0.54896516 -0.40851027  1.          1.          0.49950376
 -0.05555831  0.24666756  0.8899747   0.63955486 -1.         -0.5820037
 -0.09643647 -1.        ]
all finish
